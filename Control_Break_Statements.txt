REPORT  Z15PROG14.
"CONTROL BREAK STATEMENTS
"AT FIRST/ENDAT -> EXECUTED ONCE AT THE BEGINNING OF PROCESSING OF THE FIRST RECORD IN THE INTERNAL TABLE.
"AT LAST/ENDAT -> EXECUTED ONCE AT THE END OF PROCESSING AFTER ALL THE RECORD IN THE INTERNAL TABLE ARE PROCESSED.
"AT NEW/ENDAT -> EXECUTED WHEN THE VALUE OF A SPECIFIC FIELD CHANGES IN THE INTERNAL TABLE.
"AT END OF/ENDAT -> EXECUTED WHEN THE PROCESSING OF A SPECIFIC FIELD'S VALUE IS COMPLETE AT THE END OF THE INTERNAL TABLE OR WHEN THE ANOTHER VALUE IS ENCOUNTERD IN THE FIELD.

DATA : GT_EKPO TYPE STANDARD TABLE OF EKPO,
      GS_EKPO TYPE EKPO.

DATA : GV_EBELN TYPE EKPO-EBELN.

SELECT-OPTIONS : S_EBELN FOR GV_EBELN.

START-OF-SELECTION.
SELECT * FROM EKPO INTO TABLE GT_EKPO WHERE EBELN IN S_EBELN.
  SORT GT_EKPO BY EBELN EBELP.
LOOP AT GT_EKPO INTO GS_EKPO.
 AT FIRST.
   WRITE :/2 'PO NUMBER',15 'ITEM NO',30 'MATERIAL CODE',50 'DESCRIPTION',90 'NET VALUE'.
   ENDAT.

AT NEW EBELN.
  ULINE.
  WRITE :/ 'NEW PO' COLOR 5.
ENDAT.

WRITE :/2 GS_EKPO-EBELN,15 GS_EKPO-EBELP,30 GS_EKPO-MATNR,50 GS_EKPO-TXZ01,90 GS_EKPO-NETWR.

AT END OF EBELN.
  SUM.
  WRITE :/50 'TOTAL VALUE OF PO' COLOR 3, GS_EKPO-NETWR.
ENDAT.

AT LAST.
  ULINE.
  SKIP 2.
  SUM.
  WRITE :/50 'TOTAL VALUE OF ALL PO' COLOR 7,GS_EKPO-NETWR.
ENDAT.


CLEAR : GS_EKPO.
ENDLOOP.
END-OF-SELECTION.