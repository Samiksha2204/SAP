REPORT  Z15PROG15.
TYPES : BEGIN OF TP_KNA1,
        KUNNR TYPE KNA1-KUNNR,
        NAME1 TYPE KNA1-NAME1,
        LAND1 TYPE KNA1-LAND1,
        ORT01 TYPE KNA1-ORT01,
        PSTLZ TYPE KNA1-PSTLZ,
        REGION TYPE KNA1-REGIO,
        ADDITIONAL,
        END OF TP_KNA1,

        BEGIN OF TP_CITY,
          ORT01 TYPE KNA1-ORT01,
        END OF TP_CITY.

*TYPES : BEGIN OF TP_KNA1,
*        CUSTOMER_ID TYPE KNA1-KUNNR,
*        CUSTOMER_NAME TYPE KNA1-NAME1,
*        LAND1 TYPE KNA1-LAND1,
*        ORT01 TYPE KNA1-ORT01,
*        PSTLZ TYPE KNA1-PSTLZ,
*        REGION TYPE KNA1-REGIO,
*        ADDITIONAL,
*        END OF TP_KNA1.

TABLES : KNA1.
DATA : GT_KNA1 TYPE TABLE OF TP_KNA1,
       GS_KNA1 TYPE TP_KNA1,
       GT_CITY TYPE TABLE OF TP_CITY,
       GS_CITY TYPE TP_CITY.



SELECT-OPTIONS : S_KUNNR FOR KNA1-KUNNR.
START-OF-SELECTION.
"DISTINCT IS USED WHENEVER YOU WANT TO FETCH  THE UNIQUE RECORDS.
SELECT DISTINCT ORT01 FROM KNA1 INTO TABLE GT_CITY WHERE KUNNR IN S_KUNNR.
  LOOP AT GT_CITY INTO GS_CITY.
    WRITE :/20 GS_CITY-ORT01.
    CLEAR : GS_CITY.
    ENDLOOP.
*SELECT * FROM KNA1 INTO TABLE GT_KNA1 WHERE KUNNR IN S_KUNNR. "SELECTING ALL THE COLUMNS INTO INTERNAL TABLE
*  "WHEN YOU ARE WORKING WITH SELECT OPTIONS YOU SHOULD USE IN OPERATOR.
*  IF SY-SUBRC = 0.
*    SORT GT_KNA1 BY KUNNR.
*    LOOP AT GT_KNA1 INTO GS_KNA1.
*      WRITE :/5 GS_KNA1-KUNNR, 20 GS_KNA1-NAME1, 50 GS_KNA1-LAND1, 65 GS_KNA1-ORT01.
*      CLEAR : GS_KNA1.
*      ENDLOOP.
*  ENDIF.


"using into system will insert the record irresprctive of the column name.
"usin into corresponding fields of system will find all the data in the database table it will search the respeective field in the internal structure with the same name.If the system able
"to find the fields in the structure with the sama name then the value will get transferred.

*SELECT KUNNR NAME1 LAND1 ORT01 PSTLZ REGIO FROM KNA1 INTO TABLE GT_KNA1 WHERE KUNNR IN S_KUNNR.
*  IF SY-SUBRC = 0.
*    SORT GT_KNA1 BY CUSTOMER_ID.
*    LOOP AT GT_KNA1 INTO GS_KNA1.
*      WRITE :/5 GS_KNA1-CUSTOMER_ID, 20 GS_KNA1-CUSTOMER_NAME, 50 GS_KNA1-LAND1, 65 GS_KNA1-ORT01.
*      CLEAR : GS_KNA1.
*      ENDLOOP.
*  ENDIF.

*SELECT KUNNR NAME1 LAND1 ORT01 PSTLZ FROM KNA1 INTO CORRESPONDING FIELDS OF TABLE GT_KNA1 WHERE KUNNR IN S_KUNNR.
*  IF SY-SUBRC = 0.
*    SORT GT_KNA1 BY KUNNR.
*    LOOP AT GT_KNA1 INTO GS_KNA1.
*      WRITE :/5 GS_KNA1-KUNNR, 20 GS_KNA1-NAME1, 50 GS_KNA1-LAND1, 65 GS_KNA1-ORT01,80 GS_KNA1-PSTLZ.
*      CLEAR : GS_KNA1.
*      ENDLOOP.
*  ENDIF.

*SELECT KUNNR NAME1 LAND1 ORT01 PSTLZ FROM KNA1 INTO CORRESPONDING FIELDS OF GS_KNA1 WHERE KUNNR IN S_KUNNR. "ACTS AS A LOOP
*  WRITE :/5 GS_KNA1-KUNNR, 20 GS_KNA1-NAME1, 50 GS_KNA1-LAND1, 65 GS_KNA1-ORT01,80 GS_KNA1-PSTLZ.
*ENDSELECT.
*END-OF-SELECTION.

*SELECT SINGLE KUNNR NAME1 LAND1 ORT01 PSTLZ FROM KNA1 INTO CORRESPONDING FIELDS OF GS_KNA1 WHERE LAND1 = 'US'. "SELECTS THE RECORD WITH FIRST MATCHING RECORD
*WRITE :/5 GS_KNA1-KUNNR, 20 GS_KNA1-NAME1, 50 GS_KNA1-LAND1, 65 GS_KNA1-ORT01,80 GS_KNA1-PSTLZ.

*UPTO ONE ROW CONCEPT
*SELECT KUNNR NAME1 LAND1 ORT01 PSTLZ FROM KNA1 INTO CORRESPONDING FIELDS OF TABLE GT_KNA1 UP TO 10 ROWS WHERE LAND1 = 'US'.
*LOOP AT GT_KNA1 INTO GS_KNA1.
*WRITE :/5 GS_KNA1-KUNNR, 20 GS_KNA1-NAME1, 50 GS_KNA1-LAND1, 65 GS_KNA1-ORT01,80 GS_KNA1-PSTLZ.
*CLEAR : GS_KNA1.
*ENDLOOP.
*ULINE.
*
*SELECT KUNNR NAME1 LAND1 ORT01 PSTLZ FROM KNA1 INTO CORRESPONDING FIELDS OF TABLE GT_KNA1 UP TO 20 ROWS.
*LOOP AT GT_KNA1 INTO GS_KNA1.
*WRITE :/5 GS_KNA1-KUNNR, 20 GS_KNA1-NAME1, 50 GS_KNA1-LAND1, 65 GS_KNA1-ORT01,80 GS_KNA1-PSTLZ.
*CLEAR : GS_KNA1.
*ENDLOOP.
*ULINE.